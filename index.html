<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Отчет по Оборудованию</title>
    <!-- Подключаем библиотеку для работы с Excel -->
    <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            margin: 20px;
            background-color: #f4f4f9;
            color: #333;
        }
        h1 {
            color: #444;
            text-align: center;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            box-shadow: 0 2px 15px rgba(0,0,0,0.1);
        }
        th, td {
            border: 1px solid #ddd;
            padding: 12px 15px;
            text-align: left;
            vertical-align: top;
        }
        thead {
            background-color: #4CAF50;
            color: white;
        }
        tbody tr:nth-child(4n-3), tbody tr:nth-child(4n-2) {
            background-color: #f9f9f9;
        }
        tbody tr:nth-child(4n-1), tbody tr:nth-child(4n) {
            background-color: #ffffff;
        }
        tr:hover {
            background-color: #e2e2e2 !important;
        }
        .photos-cell {
            padding: 10px;
        }
        .photo-container {
            display: inline-block;
            margin: 5px;
            border: 2px solid #ccc;
            border-radius: 5px;
            transition: transform 0.2s, border-color 0.2s;
            line-height: 0;
            position: relative;
        }
        .photo-container:hover {
            transform: scale(1.05);
            border-color: #4CAF50;
        }
        .photo-container img {
            width: 150px;
            height: auto;
            border-radius: 3px;
            cursor: pointer;
        }
        .address-header {
            background-color: #e7f3fe;
            font-weight: bold;
            font-size: 1.2em;
            color: #31708f;
            text-align: center;
            position: sticky;
            top: 0;
            z-index: 1;
        }
        .editable {
            cursor: pointer;
        }
        .delete-btn {
            position: absolute;
            top: -10px;
            right: -10px;
            background: red;
            color: white;
            border: none;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            opacity: 0;
            transition: opacity 0.2s;
        }
        .photo-container:hover .delete-btn {
            opacity: 1;
        }
        .add-photo-btn {
            display: inline-block;
            vertical-align: middle;
            margin: 5px;
            width: 50px;
            height: 50px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 24px;
        }
        #controls-container {
            text-align: center;
            margin-bottom: 20px;
            padding: 10px;
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .control-btn {
            padding: 10px 20px;
            font-size: 16px;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
            margin: 0 10px;
        }
        #save-btn {
            background-color: #007bff;
        }
        #save-btn:hover {
            background-color: #0056b3;
        }
        #export-btn, #export-excel-btn {
            background-color: #28a745;
        }
        #export-btn:hover, #export-excel-btn:hover {
            background-color: #218838;
        }
        /* Modal (Lightbox) Styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            padding-top: 60px;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.9);
        }
        .modal-content {
            margin: auto;
            display: block;
            width: 80%;
            max-width: 800px;
        }
        .close-modal {
            position: absolute;
            top: 15px;
            right: 35px;
            color: #f1f1f1;
            font-size: 40px;
            font-weight: bold;
            transition: 0.3s;
        }
        .close-modal:hover,
        .close-modal:focus {
            color: #bbb;
            text-decoration: none;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <h1>Обзор оборудования (19.08.2025 - 20.08.2025)</h1>
    
    <div id="controls-container">
        <button id="save-btn" class="control-btn">Сохранить изменения</button>
        <button id="export-btn" class="control-btn">Экспорт данных для GitHub</button>
        <button id="export-excel-btn" class="control-btn">Экспорт в Excel</button>
    </div>

    <table>
        <thead>
            <tr>
                <th>Дата</th>
                <th>Адрес</th>
                <th>Объект</th>
                <th>Выкладка (см)</th>
                <th>Габариты (ШхГхВ, см)</th>
                <th>Высота до стойки/полки (см)</th>
                <th>Примечания</th>
            </tr>
        </thead>
        <tbody>
            <!-- Data will be dynamically populated here -->
        </tbody>
    </table>

    <!-- The Modal -->
    <div id="myModal" class="modal">
        <span class="close-modal">&times;</span>
        <img class="modal-content" id="modal-img">
    </div>

    <script>
        const defaultEquipmentData = [
    {
        address: "Юности 72",
        items: [
            { details: ["19.08.2025", "Юности 72", "Оборудование", "73х112", "123х115х123", "94", ""], photos: [{type: 'path', value: "photo_37@19-08-2025_09-56-32"}, {type: 'path', value: "photo_38@19-08-2025_09-56-32"}, {type: 'path', value: "photo_39@19-08-2025_09-56-32"}, {type: 'path', value: "photo_40@19-08-2025_09-56-32"}, {type: 'path', value: "photo_41@19-08-2025_09-56-32"}] },
            { details: ["19.08.2025", "Юности 72", "Оборудование", "62х231", "241х105х123", "92", ""], photos: [{type: 'path', value: "photo_43@19-08-2025_10-06-05"}, {type: 'path', value: "photo_44@19-08-2025_10-06-05"}, {type: 'path', value: "photo_45@19-08-2025_10-06-05"}, {type: 'path', value: "photo_46@19-08-2025_10-06-05"}, {type: 'path', value: "photo_47@19-08-2025_10-06-05"}] },
            { details: ["19.08.2025", "Юности 72", "Оборудование", "67х202", "221х110х126", "91", ""], photos: [{type: 'path', value: "photo_48@19-08-2025_10-08-43"}, {type: 'path', value: "photo_49@19-08-2025_10-08-43"}, {type: 'path', value: "photo_50@19-08-2025_10-08-43"}, {type: 'path', value: "photo_51@19-08-2025_10-08-43"}, {type: 'path', value: "photo_52@19-08-2025_10-08-43"}, {type: 'path', value: "photo_53@19-08-2025_10-08-43"}] },
            { details: ["19.08.2025", "Юности 72", "Оборудование", "65х145", "155х117х126", "91", ""], photos: [{type: 'path', value: "photo_55@19-08-2025_10-12-34"}, {type: 'path', value: "photo_56@19-08-2025_10-12-34"}, {type: 'path', value: "photo_57@19-08-2025_10-12-34"}, {type: 'path', value: "photo_58@19-08-2025_10-12-34"}, {type: 'path', value: "photo_59@19-08-2025_10-12-34"}, {type: 'path', value: "photo_60@19-08-2025_10-12-34"}] },
            { details: ["19.08.2025", "Юности 72", "Оборудование", "58х57", "130х75х215", "-", ""], photos: [{type: 'path', value: "photo_61@19-08-2025_10-15-50"}, {type: 'path', value: "photo_62@19-08-2025_10-16-05"}] },
            { details: ["19.08.2025", "Юности 72", "Кондиционер (старый)", "-", "-", "-", ""], photos: [{type: 'path', value: "photo_63@19-08-2025_10-17-44"}, {type: 'path', value: "photo_64@19-08-2025_10-17-44"}, {type: 'path', value: "photo_65@19-08-2025_10-17-44"}] },
            { details: ["19.08.2025", "Юности 72", "Кондиционер (новый 24)", "-", "-", "-", ""], photos: [{type: 'path', value: "photo_66@19-08-2025_10-19-07"}, {type: 'path', value: "photo_67@19-08-2025_10-19-07"}, {type: 'path', value: "photo_68@19-08-2025_10-19-07"}, {type: 'path', value: "photo_69@19-08-2025_10-19-07"}] }
        ]
    },
    {
        address: "Юности 137",
        items: [
            { details: ["19.08.2025", "Юности 137", "Оборудование", "67х?", "235х110х129", "94", ""], photos: [{type: 'path', value: "photo_70@19-08-2025_10-29-51"}, {type: 'path', value: "photo_71@19-08-2025_10-29-51"}, {type: 'path', value: "photo_72@19-08-2025_10-29-51"}, {type: 'path', value: "photo_73@19-08-2025_10-29-51"}, {type: 'path', value: "photo_74@19-08-2025_10-29-51"}, {type: 'path', value: "photo_75@19-08-2025_10-29-51"}, {type: 'path', value: "photo_76@19-08-2025_10-29-51"}] },
            { details: ["19.08.2025", "Юности 137", "Кондиционер (старый)", "-", "-", "-", ""], photos: [{type: 'path', value: "photo_77@19-08-2025_10-30-49"}, {type: 'path', value: "photo_78@19-08-2025_10-30-49"}, {type: 'path', value: "photo_79@19-08-2025_10-32-23"}, {type: 'path', value: "photo_80@19-08-2025_10-32-39"}, {type: 'path', value: "photo_81@19-08-2025_10-32-39"}] },
            { details: ["19.08.2025", "Юности 137", "Оборудование", "50х65", "75х77х210", "-", ""], photos: [{type: 'path', value: "photo_82@19-08-2025_10-35-41"}, {type: 'path', value: "photo_83@19-08-2025_10-35-41"}, {type: 'path', value: "photo_84@19-08-2025_10-35-41"}] }
        ]
    },
    {
        address: "Молочная 86",
        items: [
            { details: ["19.08.2025", "Молочная 86", "Оборудование", "67х190", "203х108х126", "94", ""], photos: [{type: 'path', value: "photo_85@19-08-2025_10-47-15"}, {type: 'path', value: "photo_86@19-08-2025_10-47-15"}, {type: 'path', value: "photo_87@19-08-2025_10-47-15"}, {type: 'path', value: "photo_88@19-08-2025_10-47-15"}, {type: 'path', value: "photo_89@19-08-2025_10-47-15"}] },
            { details: ["19.08.2025", "Молочная 86", "Оборудование", "67х175", "184х110х130", "96", ""], photos: [{type: 'path', value: "photo_90@19-08-2025_10-52-06"}, {type: 'path', value: "photo_91@19-08-2025_10-52-06"}, {type: 'path', value: "photo_92@19-08-2025_10-52-06"}] },
            { details: ["19.08.2025", "Молочная 86", "Оборудование (Гнилой)", "76х240", "154х110х138", "95", ""], photos: [{type: 'path', value: "photo_94@19-08-2025_10-58-23"}, {type: 'path', value: "photo_95@19-08-2025_10-58-23"}, {type: 'path', value: "photo_96@19-08-2025_10-58-24"}, {type: 'path', value: "photo_97@19-08-2025_10-58-24"}, {type: 'path', value: "photo_98@19-08-2025_10-58-24"}] },
            { details: ["19.08.2025", "Молочная 86", "Оборудование", "50х65", "75х77х210", "-", ""], photos: [{type: 'path', value: "photo_99@19-08-2025_10-58-56"}, {type: 'path', value: "photo_100@19-08-2025_10-58-56"}] },
            { details: ["19.08.2025", "Молочная 86", "Кондиционер (старый)", "-", "-", "-", ""], photos: [{type: 'path', value: "photo_101@19-08-2025_11-00-32"}, {type: 'path', value: "photo_102@19-08-2025_11-00-32"}] }
        ]
    },
    {
        address: "Молочная 71",
        items: [
            { details: ["19.08.2025", "Молочная 71", "Оборудование (2 полки по 120)", "40х240", "255х65х210", "-", ""], photos: [{type: 'path', value: "photo_103@19-08-2025_11-12-35"}, {type: 'path', value: "photo_104@19-08-2025_11-12-35"}, {type: 'path', value: "photo_105@19-08-2025_11-12-35"}] },
            { details: ["19.08.2025", "Молочная 71", "Оборудование (4шт.)", "190х85", "200х120х130", "-", ""], photos: [{type: 'path', value: "photo_106@19-08-2025_11-14-35"}, {type: 'path', value: "photo_107@19-08-2025_11-14-35"}, {type: 'path', value: "photo_108@19-08-2025_11-14-35"}] },
            { details: ["19.08.2025", "Молочная 71", "Оборудование", "50х65", "75х77х210", "-", ""], photos: [{type: 'path', value: "photo_109@19-08-2025_11-15-29"}, {type: 'path', value: "photo_110@19-08-2025_11-15-29"}, {type: 'path', value: "photo_111@19-08-2025_11-15-29"}] },
            { details: ["19.08.2025", "Молочная 71", "Оборудование", "140х45", "153х75х200", "-", ""], photos: [{type: 'path', value: "photo_112@19-08-2025_11-16-56"}] },
            { details: ["19.08.2025", "Молочная 71", "Кондиционер", "-", "-", "-", "Зовнішній блок прихований"], photos: [{type: 'path', value: "photo_113@19-08-2025_11-18-57"}] }
        ]
    },
    {
        address: "Освітянська 18",
        items: [
            { details: ["19.08.2025", "Освітянська 18", "Оборудование (2 по 47)", "48х94", "117х66х213", "-", ""], photos: [] },
            { details: ["19.08.2025", "Освітянська 18", "Кондиціонер (старий)", "-", "-", "-", ""], photos: [{type: 'path', value: "photo_114@19-08-2025_11-45-16"}, {type: 'path', value: "photo_115@19-08-2025_11-45-16"}, {type: 'path', value: "photo_116@19-08-2025_11-45-23"}, {type: 'path', value: "photo_117@19-08-2025_11-45-23"}] }
        ]
    },
    {
        address: "Передатка",
        items: [
            { details: ["19.08.2025", "Передатка", "Оборудование", "56х43", "68х64х213", "-", ""], photos: [{type: 'path', value: "photo_118@19-08-2025_12-03-32"}] },
            { details: ["19.08.2025", "Передатка", "Оборудование (2 полиці по 120)", "40х240", "255х65х210", "-", ""], photos: [{type: 'path', value: "photo_119@19-08-2025_12-04-43"}, {type: 'path', value: "photo_120@19-08-2025_12-04-43"}] },
            { details: ["19.08.2025", "Передатка", "Оборудование (2шт.)", "(250х89)+(180х89)", "(258/190)х110х113", "85", ""], photos: [{type: 'path', value: "photo_121@19-08-2025_12-15-38"}, {type: 'path', value: "photo_122@19-08-2025_12-15-38"}] },
            { details: ["19.08.2025", "Передатка", "Оборудование (2шт.)", "(155х89)+(185х89)", "(160/190)х110х113", "85", ""], photos: [{type: 'path', value: "photo_123@19-08-2025_12-19-45"}] },
            { details: ["19.08.2025", "Передатка", "Оборудование", "225х68", "240х108х120", "90", ""], photos: [{type: 'path', value: "photo_128@19-08-2025_12-51-18"}, {type: 'path', value: "photo_129@19-08-2025_12-51-18"}, {type: 'path', value: "photo_130@19-08-2025_12-51-18"}, {type: 'path', value: "photo_131@19-08-2025_12-51-18"}] },
            { details: ["19.08.2025", "Передатка", "Оборудование", "140х65+(110х65)", "275х110х123", "90", "Діагональ, биті стекла"], photos: [{type: 'path', value: "photo_132@19-08-2025_12-52-18"}, {type: 'path', value: "photo_133@19-08-2025_12-52-18"}, {type: 'path', value: "photo_134@19-08-2025_12-52-18"}] },
            { details: ["19.08.2025", "Передатка", "Оборудование (Розібраний)", "-", "-", "-", ""], photos: [{type: 'path', value: "photo_135@19-08-2025_12-53-31"}, {type: 'path', value: "photo_136@19-08-2025_12-53-31"}] },
            { details: ["19.08.2025", "Передатка", "Кондиціонер (новий 24)", "-", "-", "-", ""], photos: [{type: 'path', value: "photo_125@19-08-2025_12-20-29"}, {type: 'path', value: "photo_126@19-08-2025_12-22-53"}, {type: 'path', value: "photo_127@19-08-2025_12-22-53"}] }
        ]
    },
    {
        address: "Корищенка",
        items: [
            { details: ["19.08.2025", "Корищенка", "Оборудование", "55х63", "75х80х205", "-", ""], photos: [{type: 'path', value: "photo_137@19-08-2025_13-05-47"}] },
            { details: ["19.08.2025", "Корищенка", "Оборудование", "64х56", "774х76х227", "-", ""], photos: [{type: 'path', value: "photo_138@19-08-2025_13-07-22"}] },
            { details: ["19.08.2025", "Корищенка", "Оборудование", "58х47,5", "68х65х215", "-", ""], photos: [{type: 'path', value: "photo_139@19-08-2025_13-09-31"}] },
            { details: ["19.08.2025", "Корищенка", "Оборудование", "150х65", "160х100х125", "95", ""], photos: [{type: 'path', value: "photo_140@19-08-2025_13-11-59"}, {type: 'path', value: "photo_141@19-08-2025_13-11-59"}] },
            { details: ["19.08.2025", "Корищенка", "Оборудование", "195х70", "205х110х124", "93", "Компресор відповідає моделі"], photos: [{type: 'path', value: "photo_142@19-08-2025_13-13-55"}, {type: 'path', value: "photo_143@19-08-2025_13-13-55"}, {type: 'path', value: "photo_144@19-08-2025_13-13-55"}] },
            { details: ["19.08.2025", "Корищенка", "Оборудование", "50х65", "75х77х210", "-", ""], photos: [{type: 'path', value: "photo_145@19-08-2025_13-14-51"}] }
        ]
    },
    {
        address: "Карпенко-Карого",
        items: [
            { details: ["19.08.2025", "Карпенко-Карого", "Оборудование", "50х65", "75х77х210", "-", ""], photos: [{type: 'path', value: "photo_146@19-08-2025_13-19-50"}] },
            { details: ["19.08.2025", "Карпенко-Карого", "Оборудование", "145х65", "150х92х126", "86", ""], photos: [{type: 'path', value: "photo_147@19-08-2025_13-22-50"}, {type: 'path', value: "photo_148@19-08-2025_13-22-51"}, {type: 'path', value: "photo_149@19-08-2025_13-22-51"}, {type: 'path', value: "photo_150@19-08-2025_13-22-51"}] }
        ]
    },
    {
        address: "Магістральна",
        items: [
            { details: ["19.08.2025", "Магістральна", "Оборудование", "190х80", "198,5х120х129", "93", ""], photos: [{type: 'path', value: "photo_151@19-08-2025_13-57-00"}, {type: 'path', value: "photo_152@19-08-2025_13-57-00"}, {type: 'path', value: "photo_153@19-08-2025_13-57-00"}, {type: 'path', value: "photo_154@19-08-2025_13-57-00"}, {type: 'path', value: "photo_155@19-08-2025_13-57-00"}, {type: 'path', value: "photo_156@19-08-2025_13-57-00"}, {type: 'path', value: "photo_157@19-08-2025_13-57-00"}, {type: 'path', value: "photo_158@19-08-2025_13-57-13"}] },
            { details: ["19.08.2025", "Магістральна", "Оборудование", "190х80", "198,5х120х129", "93", ""], photos: [{type: 'path', value: "photo_159@19-08-2025_13-59-59"}, {type: 'path', value: "photo_160@19-08-2025_13-59-59"}, {type: 'path', value: "photo_161@19-08-2025_13-59-59"}, {type: 'path', value: "photo_162@19-08-2025_13-59-59"}] },
            { details: ["19.08.2025", "Магістральна", "Оборудование (2 полиці 91х40)", "182х40", "195х66х207", "-", ""], photos: [{type: 'path', value: "photo_163@19-08-2025_14-04-58"}] },
            { details: ["19.08.2025", "Магістральна", "Оборудование (2 полиці 95х43)", "190х43", "?х71х203", "75", ""], photos: [{type: 'path', value: "photo_164@19-08-2025_14-10-19"}] },
            { details: ["19.08.2025", "Магістральна", "Оборудование (Немає верхньої планки)", "190х82", "200х120х93", "-", ""], photos: [{type: 'path', value: "photo_165@19-08-2025_14-12-32"}] },
            { details: ["19.08.2025", "Магістральна", "Кондиціонер (старий)", "-", "-", "-", ""], photos: [{type: 'path', value: "photo_166@19-08-2025_14-13-36"}, {type: 'path', value: "photo_167@19-08-2025_14-13-36"}] }
        ]
    },
    {
        address: "Фортечна",
        items: [
            { details: ["19.08.2025", "Фортечна", "Оборудование", "58х47", "68х63х214", "-", ""], photos: [{type: 'path', value: "photo_168@19-08-2025_14-26-01"}, {type: 'path', value: "photo_169@19-08-2025_14-26-01"}] },
            { details: ["19.08.2025", "Фортечна", "Оборудование", "56х54", "68х68х208", "-", ""], photos: [{type: 'path', value: "photo_170@19-08-2025_14-27-52"}] },
            { details: ["19.08.2025", "Фортечна", "Оборудование", "58х57", "130х740х216", "-", ""], photos: [{type: 'path', value: "photo_171@19-08-2025_14-28-59"}] },
            { details: ["19.08.2025", "Фортечна", "Оборудование", "193х68", "206х107х123", "94", ""], photos: [{type: 'path', value: "photo_172@19-08-2025_14-30-21"}, {type: 'path', value: "photo_173@19-08-2025_14-30-21"}, {type: 'path', value: "photo_174@19-08-2025_14-30-21"}] },
            { details: ["19.08.2025", "Фортечна", "Оборудование (Двокомпресорний)", "(143х65)+(145х65)", "300х110х124", "93", ""], photos: [{type: 'path', value: "photo_175@19-08-2025_14-33-05"}, {type: 'path', value: "photo_176@19-08-2025_14-33-05"}, {type: 'path', value: "photo_177@19-08-2025_14-33-05"}, {type: 'path', value: "photo_178@19-08-2025_14-33-05"}, {type: 'path', value: "photo_179@19-08-2025_14-33-05"}, {type: 'path', value: "photo_180@19-08-2025_14-33-05"}] },
            { details: ["19.08.2025", "Фортечна", "Кондиціонер (старий 24)", "-", "-", "-", ""], photos: [{type: 'path', value: "photo_181@19-08-2025_14-35-18"}, {type: 'path', value: "photo_182@19-08-2025_14-35-18"}, {type: 'path', value: "photo_183@19-08-2025_14-35-18"}] },
            { details: ["19.08.2025", "Фортечна", "Кондиціонери (старі)", "-", "-", "-", ""], photos: [{type: 'path', value: "photo_184@19-08-2025_14-36-26"}, {type: 'path', value: "photo_185@19-08-2025_14-36-26"}, {type: 'path', value: "photo_186@19-08-2025_14-36-26"}, {type: 'path', value: "photo_187@19-08-2025_14-36-53"}, {type: 'path', value: "photo_189@19-08-2025_14-36-53"}] }
        ]
    },
    {
        address: "Фільтрова",
        items: [
            { details: ["19.08.2025", "Фільтрова", "Оборудование", "58х57", "130х740х216", "-", ""], photos: [{type: 'path', value: "photo_190@19-08-2025_15-14-48"}] },
            { details: ["19.08.2025", "Фільтрова", "Оборудование", "560х500", "68х66х215", "-", ""], photos: [{type: 'path', value: "photo_191@19-08-2025_15-17-48"}] },
            { details: ["19.08.2025", "Фільтрова", "Оборудование", "144х70", "158х106х124", "94", ""], photos: [{type: 'path', value: "photo_192@19-08-2025_15-20-08"}, {type: 'path', value: "photo_193@19-08-2025_15-20-08"}, {type: 'path', value: "photo_194@19-08-2025_15-20-08"}] },
            { details: ["19.08.2025", "Фільтрова", "Оборудование", "195х65", "205х110х130", "95", ""], photos: [{type: 'path', value: "photo_195@19-08-2025_15-22-17"}, {type: 'path', value: "photo_196@19-08-2025_15-23-06"}, {type: 'path', value: "photo_197@19-08-2025_15-23-06"}, {type: 'path', value: "photo_198@19-08-2025_15-23-06"}, {type: 'path', value: "photo_199@19-08-2025_15-23-06"}] }
        ]
    },
    {
        address: "БГ",
        items: [
            { details: ["20.08.2025", "БГ", "Оборудование (4шт.)", "63х190", "202х100х127", "99", ""], photos: [{type: 'path', value: "photo_200@20-08-2025_09-33-42"}, {type: 'path', value: "photo_201@20-08-2025_09-33-42"}, {type: 'path', value: "photo_202@20-08-2025_09-33-42"}, {type: 'path', value: "photo_203@20-08-2025_09-33-42"}, {type: 'path', value: "photo_204@20-08-2025_09-33-42"}, {type: 'path', value: "photo_205@20-08-2025_09-33-42"}, {type: 'path', value: "photo_206@20-08-2025_09-33-42"}, {type: 'path', value: "photo_207@20-08-2025_09-33-42"}, {type: 'path', value: "photo_208@20-08-2025_09-33-42"}] },
            { details: ["20.08.2025", "БГ", "Оборудование (2 полиці 91х40)", "182х40", "195х66х207", "-", ""], photos: [{type: 'path', value: "photo_209@20-08-2025_09-34-28"}] },
            { details: ["20.08.2025", "БГ", "Оборудование", "58х57", "130х740х216", "-", ""], photos: [{type: 'path', value: "photo_210@20-08-2025_09-35-28"}] },
            { details: ["20.08.2025", "БГ", "Оборудование (основа 190х60)", "190х430", "200х850х195", "-", ""], photos: [{type: 'path', value: "photo_211@20-08-2025_09-37-29"}] },
            { details: ["20.08.2025", "БГ", "Кондиціонери (нові)", "-", "-", "-", ""], photos: [{type: 'path', value: "photo_212@20-08-2025_09-47-03"}, {type: 'path', value: "photo_213@20-08-2025_09-48-13"}, {type: 'path', value: "photo_214@20-08-2025_09-48-32"}, {type: 'path', value: "photo_216@20-08-2025_09-48-32"}, {type: 'path', value: "photo_217@20-08-2025_09-49-22"}, {type: 'path', value: "photo_218@20-08-2025_09-49-30"}] }
        ]
    },
    {
        address: "Дружня 2",
        items: [
            { details: ["20.08.2025", "Дружня 2", "Оборудование", "30х100", "124х65х204", "74", ""], photos: [{type: 'path', value: "photo_219@20-08-2025_10-24-57"}] },
            { details: ["20.08.2025", "Дружня 2", "Оборудование", "89х(156+190)", "355х110х113", "85", ""], photos: [{type: 'path', value: "photo_220@20-08-2025_10-29-17"}, {type: 'path', value: "photo_221@20-08-2025_10-29-17"}, {type: 'path', value: "photo_222@20-08-2025_10-29-17"}, {type: 'path', value: "photo_223@20-08-2025_10-29-17"}, {type: 'path', value: "photo_224@20-08-2025_10-29-17"}, {type: 'path', value: "photo_225@20-08-2025_10-29-17"}] },
            { details: ["20.08.2025", "Дружня 2", "Оборудование", "89х(156+125)", "291х110х113", "85", ""], photos: [{type: 'path', value: "photo_226@20-08-2025_10-31-11"}, {type: 'path', value: "photo_227@20-08-2025_10-31-11"}, {type: 'path', value: "photo_228@20-08-2025_10-31-11"}, {type: 'path', value: "photo_229@20-08-2025_10-31-11"}, {type: 'path', value: "photo_230@20-08-2025_10-31-11"}] },
            { details: ["20.08.2025", "Дружня 2", "Оборудование", "58х57", "130х740х216", "-", ""], photos: [{type: 'path', value: "photo_231@20-08-2025_10-32-44"}] },
            { details: ["20.08.2025", "Дружня 2", "Кондиціонер (новий 24)", "-", "-", "-", ""], photos: [{type: 'path', value: "photo_232@20-08-2025_10-33-40"}, {type: 'path', value: "photo_233@20-08-2025_10-33-40"}] },
            { details: ["20.08.2025", "Дружня 2", "Кондиціонер (новий)", "-", "-", "-", ""], photos: [{type: 'path', value: "photo_234@20-08-2025_10-33-48"}] }
        ]
    },
    {
        address: "Нижня Хортиця",
        items: [
            { details: ["20.08.2025", "Нижня Хортиця", "Оборудование", "70х150", "162х103х125", "93", ""], photos: [{type: 'path', value: "photo_235@20-08-2025_10-47-11"}, {type: 'path', value: "photo_236@20-08-2025_10-47-11"}, {type: 'path', value: "photo_237@20-08-2025_10-47-11"}, {type: 'path', value: "photo_238@20-08-2025_10-47-11"}] },
            { details: ["20.08.2025", "Нижня Хортиця", "Оборудование", "76х172", "180х108х122", "-", ""], photos: [{type: 'path', value: "photo_239@20-08-2025_10-50-58"}, {type: 'path', value: "photo_240@20-08-2025_10-50-58"}, {type: 'path', value: "photo_241@20-08-2025_10-50-58"}, {type: 'path', value: "photo_242@20-08-2025_10-50-58"}] },
            { details: ["20.08.2025", "Нижня Хортиця", "Оборудование", "59х47", "68х65х215", "-", ""], photos: [{type: 'path', value: "photo_243@20-08-2025_10-52-21"}] },
            { details: ["20.08.2025", "Нижня Хортиця", "Оборудование", "73,5х60", "130х76х215", "-", ""], photos: [{type: 'path', value: "photo_244@20-08-2025_10-53-42"}, {type: 'path', value: "photo_245@20-08-2025_10-53-55"}] },
            { details: ["20.08.2025", "Нижня Хортиця", "Кондиціонер (старий)", "-", "-", "-", ""], photos: [{type: 'path', value: "photo_246@20-08-2025_10-54-41"}, {type: 'path', value: "photo_247@20-08-2025_10-54-41"}] }
        ]
    },
    {
        address: "Мира 79, Розумівка",
        items: [
            { details: ["20.08.2025", "Мира 79, Розумівка", "Оборудование", "58х57", "130х740х216", "-", ""], photos: [{type: 'path', value: "photo_248@20-08-2025_11-04-11"}, {type: 'path', value: "photo_249@20-08-2025_11-04-51"}] },
            { details: ["20.08.2025", "Мира 79, Розумівка", "Оборудование", "195х70", "205х110х133", "93", ""], photos: [{type: 'path', value: "photo_250@20-08-2025_11-06-43"}, {type: 'path', value: "photo_251@20-08-2025_11-06-43"}, {type: 'path', value: "photo_252@20-08-2025_11-06-43"}, {type: 'path', value: "photo_253@20-08-2025_11-06-43"}] },
            { details: ["20.08.2025", "Мира 79, Розумівка", "Оборудование", "140х60", "153х100х133", "94", ""], photos: [{type: 'path', value: "photo_254@20-08-2025_11-08-11"}, {type: 'path', value: "photo_255@20-08-2025_11-08-11"}, {type: 'path', value: "photo_256@20-08-2025_11-08-11"}, {type: 'path', value: "photo_257@20-08-2025_11-08-11"}, {type: 'path', value: "photo_258@20-08-2025_11-08-11"}] },
            { details: ["20.08.2025", "Мира 79, Розумівка", "Кондиціонер (старий)", "-", "-", "-", ""], photos: [{type: 'path', value: "photo_259@20-08-2025_11-09-36"}, {type: 'path', value: "photo_260@20-08-2025_11-09-36"}] }
        ]
    },
    {
        address: "Миру 37",
        items: [
            { details: ["20.08.2025", "Миру 37", "Оборудование", "58х57", "130х740х216", "-", ""], photos: [{type: 'path', value: "photo_261@20-08-2025_11-12-43"}, {type: 'path', value: "photo_262@20-08-2025_11-13-14"}] },
            { details: ["20.08.2025", "Миру 37", "Оборудование", "75х174", "184х110х142", "97", ""], photos: [{type: 'path', value: "photo_263@20-08-2025_11-16-07"}, {type: 'path', value: "photo_264@20-08-2025_11-16-07"}, {type: 'path', value: "photo_265@20-08-2025_11-16-07"}] },
            { details: ["20.08.2025", "Миру 37", "Оборудование", "195х75", "205х120х139", "93", ""], photos: [{type: 'path', value: "photo_266@20-08-2025_11-17-46"}, {type: 'path', value: "photo_267@20-08-2025_11-17-46"}, {type: 'path', value: "photo_268@20-08-2025_11-17-46"}, {type: 'path', value: "photo_269@20-08-2025_11-17-46"}] },
            { details: ["20.08.2025", "Миру 37", "Оборудование", "144х70", "155х110х126", "94", ""], photos: [{type: 'path', value: "photo_270@20-08-2025_11-19-01"}, {type: 'path', value: "photo_271@20-08-2025_11-19-01"}, {type: 'path', value: "photo_272@20-08-2025_11-19-01"}, {type: 'path', value: "photo_273@20-08-2025_11-19-01"}, {type: 'path', value: "photo_274@20-08-2025_11-19-01"}] },
            { details: ["20.08.2025", "Миру 37", "Кондиціонер (старий)", "-", "-", "-", ""], photos: [{type: 'path', value: "photo_275@20-08-2025_11-23-43"}, {type: 'path', value: "photo_276@20-08-2025_11-23-43"}, {type: 'path', value: "photo_277@20-08-2025_11-23-44"}, {type: 'path', value: "photo_278@20-08-2025_11-23-44"}] }
        ]
    },
    {
        address: "Мар'ївка",
        items: [
            { details: ["20.08.2025", "Мар'ївка", "Оборудование", "115х43", "125х87х220", "75", ""], photos: [{type: 'path', value: "photo_279@20-08-2025_11-39-18"}] },
            { details: ["20.08.2025", "Мар'ївка", "Оборудование", "150х70", "160х110х127", "95", ""], photos: [{type: 'path', value: "photo_280@20-08-2025_11-40-46"}, {type: 'path', value: "photo_281@20-08-2025_11-40-46"}, {type: 'path', value: "photo_282@20-08-2025_11-40-46"}] },
            { details: ["20.08.2025", "Мар'ївка", "Оборудование", "193х73", "205х110х133", "93", ""], photos: [{type: 'path', value: "photo_283@20-08-2025_11-42-00"}, {type: 'path', value: "photo_284@20-08-2025_11-42-00"}, {type: 'path', value: "photo_285@20-08-2025_11-42-00"}] },
            { details: ["20.08.2025", "Мар'ївка", "Оборудование (2шт.)", "114х60", "120х100х130", "87", ""], photos: [{type: 'path', value: "photo_286@20-08-2025_11-43-38"}, {type: 'path', value: "photo_287@20-08-2025_11-43-38"}, {type: 'path', value: "photo_288@20-08-2025_11-43-47"}, {type: 'path', value: "photo_289@20-08-2025_11-43-47"}] },
            { details: ["20.08.2025", "Мар'ївка", "Оборудование", "58х57", "130х740х216", "-", ""], photos: [{type: 'path', value: "photo_290@20-08-2025_11-44-35"}] },
            { details: ["20.08.2025", "Мар'ївка", "Оборудование", "58х47,5", "68х65х215", "-", ""], photos: [{type: 'path', value: "photo_291@20-08-2025_11-45-52"}] }
        ]
    },
    {
        address: "Нове Запоріжжя",
        items: [
            { details: ["20.08.2025", "Нове Запоріжжя", "Оборудование", "58х57", "130х740х216", "-", ""], photos: [{type: 'path', value: "photo_292@20-08-2025_12-09-26"}] },
            { details: ["20.08.2025", "Нове Запоріжжя", "Оборудование", "70х(110+90)", "(172/162)х110х125", "93", ""], photos: [{type: 'path', value: "photo_293@20-08-2025_12-18-12"}, {type: 'path', value: "photo_294@20-08-2025_12-18-12"}, {type: 'path', value: "photo_295@20-08-2025_12-18-12"}] },
            { details: ["20.08.2025", "Нове Запоріжжя", "Оборудование", "194х70", "205х110х125", "93", ""], photos: [{type: 'path', value: "photo_296@20-08-2025_12-18-15"}, {type: 'path', value: "photo_297@20-08-2025_12-18-15"}, {type: 'path', value: "photo_298@20-08-2025_12-18-15"}, {type: 'path', value: "photo_299@20-08-2025_12-18-18"}, {type: 'path', value: "photo_300@20-08-2025_12-18-18"}, {type: 'path', value: "photo_301@20-08-2025_12-18-18"}] }
        ]
    },
    {
        address: "Нове Запоріжжя 35",
        items: [
            { details: ["20.08.2025", "Нове Запоріжжя 35", "Оборудование", "58х57", "130х740х216", "-", ""], photos: [{type: 'path', value: "photo_302@20-08-2025_12-28-15"}] },
            { details: ["20.08.2025", "Нове Запоріжжя 35", "Оборудование", "59х47", "68х65х215", "-", ""], photos: [{type: 'path', value: "photo_303@20-08-2025_12-30-15"}, {type: 'path', value: "photo_304@20-08-2025_12-31-01"}] },
            { details: ["20.08.2025", "Нове Запоріжжя 35", "Оборудование", "50х(85+85)", "185х90х110", "90", ""], photos: [{type: 'path', value: "photo_305@20-08-2025_12-33-26"}, {type: 'path', value: "photo_306@20-08-2025_12-33-26"}, {type: 'path', value: "photo_307@20-08-2025_12-33-26"}] },
            { details: ["20.08.2025", "Нове Запоріжжя 35", "Оборудование", "55х(97+97)", "205х90х110", "90", ""], photos: [{type: 'path', value: "photo_308@20-08-2025_12-34-59"}, {type: 'path', value: "photo_309@20-08-2025_12-34-59"}, {type: 'path', value: "photo_310@20-08-2025_12-34-59"}] },
            { details: ["20.08.2025", "Нове Запоріжжя 35", "Оборудование (Двокомпресорний)", "70х(145+145)", "300х110х133", "93", ""], photos: [{type: 'path', value: "photo_311@20-08-2025_12-37-21"}, {type: 'path', value: "photo_312@20-08-2025_12-37-21"}] },
            { details: ["20.08.2025", "Нове Запоріжжя 35", "Оборудование", "115х70", "125х90х133", "93", ""], photos: [{type: 'path', value: "photo_313@20-08-2025_12-38-37"}, {type: 'path', value: "photo_314@20-08-2025_12-38-37"}, {type: 'path', value: "photo_315@20-08-2025_12-38-37"}, {type: 'path', value: "photo_316@20-08-2025_12-38-37"}] },
            { details: ["20.08.2025", "Нове Запоріжжя 35", "Кондиціонер (новий 24)", "-", "-", "-", ""], photos: [{type: 'path', value: "photo_317@20-08-2025_12-39-47"}, {type: 'path', value: "photo_318@20-08-2025_12-39-47"}, {type: 'path', value: "photo_319@20-08-2025_12-39-47"}] }
        ]
    },
    {
        address: "Нове Запоріжжя, 47",
        items: [
            { details: ["20.08.2025", "Нове Запоріжжя, 47", "Кондиціонер (новий 24)", "-", "-", "-", ""], photos: [{type: 'path', value: "photo_320@20-08-2025_12-56-42"}, {type: 'path', value: "photo_321@20-08-2025_12-56-42"}, {type: 'path', value: "photo_322@20-08-2025_12-56-42"}] },
            { details: ["20.08.2025", "Нове Запоріжжя, 47", "Оборудование", "59х47", "68х65х215", "-", ""], photos: [{type: 'path', value: "photo_323@20-08-2025_12-57-01"}, {type: 'path', value: "photo_324@20-08-2025_12-57-59"}] },
            { details: ["20.08.2025", "Нове Запоріжжя, 47", "Оборудование", "64х63", "75х78х206", "-", ""], photos: [{type: 'path', value: "photo_325@20-08-2025_12-59-18"}] },
            { details: ["20.08.2025", "Нове Запоріжжя, 47", "Оборудование", "145х70", "150х105х125", "95", ""], photos: [{type: 'path', value: "photo_326@20-08-2025_13-18-31"}, {type: 'path', value: "photo_327@20-08-2025_13-18-31"}, {type: 'path', value: "photo_328@20-08-2025_13-18-31"}] },
            { details: ["20.08.2025", "Нове Запоріжжя, 47", "Оборудование", "190х80", "200х115х135", "95", ""], photos: [{type: 'path', value: "photo_329@20-08-2025_13-18-37"}, {type: 'path', value: "photo_330@20-08-2025_13-18-37"}, {type: 'path', value: "photo_331@20-08-2025_13-18-37"}] }
        ]
    },
    {
        address: "Широке",
        items: [
            { details: ["20.08.2025", "Широке", "Оборудование", "58х57", "130х740х216", "-", ""], photos: [{type: 'path', value: "photo_332@20-08-2025_13-21-38"}] },
            { details: ["20.08.2025", "Широке", "Оборудование", "50х34", "59х56х205", "-", ""], photos: [{type: 'path', value: "photo_333@20-08-2025_13-23-57"}] },
            { details: ["20.08.2025", "Широке", "Оборудование", "70х194(97+97)", "205х107х126", "93", ""], photos: [{type: 'path', value: "photo_334@20-08-2025_13-26-32"}, {type: 'path', value: "photo_335@20-08-2025_13-26-32"}, {type: 'path', value: "photo_336@20-08-2025_13-26-32"}, {type: 'path', value: "photo_337@20-08-2025_13-26-32"}] },
            { details: ["20.08.2025", "Широке", "Оборудование", "174х70", "183х105х124", "95", ""], photos: [{type: 'path', value: "photo_338@20-08-2025_13-28-39"}, {type: 'path', value: "photo_339@20-08-2025_13-28-39"}, {type: 'path', value: "photo_340@20-08-2025_13-28-39"}, {type: 'path', value: "photo_341@20-08-2025_13-28-39"}] },
            { details: ["20.08.2025", "Широке", "Кондиціонери (старі 12)", "-", "-", "-", ""], photos: [{type: 'path', value: "photo_342@20-08-2025_13-29-18"}, {type: 'path', value: "photo_343@20-08-2025_13-29-18"}, {type: 'path', value: "photo_344@20-08-2025_13-29-58"}, {type: 'path', value: "photo_345@20-08-2025_13-29-58"}, {type: 'path', value: "photo_346@20-08-2025_13-29-58"}, {type: 'path', value: "photo_347@20-08-2025_13-41-38"}, {type: 'path', value: "photo_348@20-08-2025_13-41-38"}, {type: 'path', value: "photo_349@20-08-2025_13-41-38"}] }
        ]
    },
    {
        address: "Володимир",
        items: [
            { details: ["20.08.2025", "Володимир", "Оборудование (полиця 190х43)", "65х187", "205х87х195", "65", ""], photos: [{type: 'path', value: "photo_350@20-08-2025_14-02-38"}] },
            { details: ["20.08.2025", "Володимир", "Оборудование", "175х65", "185х100х130", "95", ""], photos: [{type: 'path', value: "photo_351@20-08-2025_14-04-50"}, {type: 'path', value: "photo_352@20-08-2025_14-04-50"}, {type: 'path', value: "photo_353@20-08-2025_14-04-50"}] },
            { details: ["20.08.2025", "Володимир", "Оборудование", "190х65", "200х100х130", "95", ""], photos: [{type: 'path', value: "photo_354@20-08-2025_14-06-28"}, {type: 'path', value: "photo_355@20-08-2025_14-06-28"}, {type: 'path', value: "photo_356@20-08-2025_14-06-28"}] },
            { details: ["20.08.2025", "Володимир", "Оборудование (2шт.)", "149х75", "157х110х132", "92", ""], photos: [{type: 'path', value: "photo_357@20-08-2025_14-07-43"}, {type: 'path', value: "photo_358@20-08-2025_14-07-43"}, {type: 'path', value: "photo_359@20-08-2025_14-07-43"}, {type: 'path', value: "photo_360@20-08-2025_14-09-03"}, {type: 'path', value: "photo_361@20-08-2025_14-09-03"}, {type: 'path', value: "photo_362@20-08-2025_14-09-03"}, {type: 'path', value: "photo_363@20-08-2025_14-09-03"}] },
            { details: ["20.08.2025", "Володимир", "Оборудование (2 полиці по 120)", "40х240", "255х65х210", "-", ""], photos: [{type: 'path', value: "photo_364@20-08-2025_14-11-33"}, {type: 'path', value: "photo_365@20-08-2025_14-11-33"}] },
            { details: ["20.08.2025", "Володимир", "Оборудование", "60х63", "75х79х212", "-", ""], photos: [{type: 'path', value: "photo_366@20-08-2025_14-15-25"}] },
            { details: ["20.08.2025", "Володимир", "Кондиціонер (старий)", "-", "-", "-", ""], photos: [{type: 'path', value: "photo_367@20-08-2025_14-17-59"}] },
            { details: ["20.08.2025", "Володимир", "Кондиціонери (нові)", "-", "-", "-", ""], photos: [{type: 'path', value: "photo_368@20-08-2025_14-25-56"}, {type: 'path', value: "photo_369@20-08-2025_14-25-56"}, {type: 'path', value: "photo_370@20-08-2025_14-25-56"}, {type: 'path', value: "photo_371@20-08-2025_14-25-56"}, {type: 'path', value: "photo_372@20-08-2025_14-25-56"}, {type: 'path', value: "photo_373@20-08-2025_14-25-56"}, {type: 'path', value: "photo_374@20-08-2025_14-25-56"}, {type: 'path', value: "photo_375@20-08-2025_14-25-56"}, {type: 'path', value: "photo_376@20-08-2025_14-25-56"}] }
        ]
    },
    {
        address: "Синенка 11",
        items: [
            { details: ["20.08.2025", "Синенка 11", "Оборудование (2шт.)", "58х57", "130х740х216", "-", ""], photos: [{type: 'path', value: "photo_377@20-08-2025_14-44-10"}, {type: 'path', value: "photo_378@20-08-2025_14-46-14"}] },
            { details: ["20.08.2025", "Синенка 11", "Кондиціонер (старий)", "-", "-", "-", ""], photos: [{type: 'path', value: "photo_379@20-08-2025_14-47-07"}, {type: 'path', value: "photo_380@20-08-2025_14-47-07"}] },
            { details: ["20.08.2025", "Синенка 11", "Оборудование", "70х191", "200х96х134", "97", ""], photos: [{type: 'path', value: "photo_381@20-08-2025_14-51-10"}, {type: 'path', value: "photo_382@20-08-2025_14-51-10"}] },
            { details: ["20.08.2025", "Синенка 11", "Оборудование", "71х125", "133х111х136", "98", ""], photos: [{type: 'path', value: "photo_383@20-08-2025_14-56-10"}, {type: 'path', value: "photo_384@20-08-2025_14-56-10"}, {type: 'path', value: "photo_385@20-08-2025_14-56-10"}] },
            { details: ["20.08.2025", "Синенка 11", "Оборудование (полиця 125х41)", "125х63", "131х82х196", "-", ""], photos: [{type: 'path', value: "photo_386@20-08-2025_14-59-47"}] }
        ]
    },
    {
        address: "Синенка 27",
        items: [
            { details: ["20.08.2025", "Синенка 27", "Оборудование", "59х47", "68х65х215", "-", ""], photos: [{type: 'path', value: "photo_387@20-08-2025_15-21-07"}] },
            { details: ["20.08.2025", "Синенка 27", "Оборудование", "58х57", "130х740х216", "-", ""], photos: [{type: 'path', value: "photo_388@20-08-2025_15-21-49"}] },
            { details: ["20.08.2025", "Синенка 27", "Оборудование", "59х47", "68х65х215", "-", ""], photos: [{type: 'path', value: "photo_389@20-08-2025_15-22-53"}] },
            { details: ["20.08.2025", "Синенка 27", "Оборудование", "58х115", "125х90х128", "88", ""], photos: [{type: 'path', value: "photo_390@20-08-2025_15-27-05"}, {type: 'path', value: "photo_391@20-08-2025_15-27-05"}, {type: 'path', value: "photo_392@20-08-2025_15-27-05"}] },
            { details: ["20.08.2025", "Синенка 27", "Оборудование", "70х120", "128х111х128", "92,5", ""], photos: [{type: 'path', value: "photo_393@20-08-2025_15-29-57"}, {type: 'path', value: "photo_394@20-08-2025_15-29-57"}, {type: 'path', value: "photo_395@20-08-2025_15-29-57"}] },
            { details: ["20.08.2025", "Синенка 27", "Оборудование", "174х70", "185х110х130", "95", ""], photos: [{type: 'path', value: "photo_396@20-08-2025_15-31-36"}, {type: 'path', value: "photo_397@20-08-2025_15-31-36"}, {type: 'path', value: "photo_398@20-08-2025_15-31-36"}] },
            { details: ["20.08.2025", "Синенка 27", "Оборудование", "145х70", "156х110х133", "93", ""], photos: [{type: 'path', value: "photo_399@20-08-2025_15-34-55"}, {type: 'path', value: "photo_400@20-08-2025_15-34-55"}, {type: 'path', value: "photo_401@20-08-2025_15-34-55"}] },
            { details: ["20.08.2025", "Синенка 27", "Кондиціонери (нові)", "-", "-", "-", ""], photos: [{type: 'path', value: "photo_402@20-08-2025_15-40-44"}, {type: 'path', value: "photo_403@20-08-2025_15-40-44"}, {type: 'path', value: "photo_404@20-08-2025_15-40-58"}, {type: 'path', value: "photo_405@20-08-2025_15-40-58"}] }
        ]
    },
    {
        address: "93 бригада",
        items: [
            { details: ["20.08.2025", "93 бригада", "Оборудование", "58х57", "130х740х216", "-", ""], photos: [{type: 'path', value: "photo_406@20-08-2025_16-06-22"}] },
            { details: ["20.08.2025", "93 бригада", "Оборудование", "50х65", "75х77х210", "-", ""], photos: [{type: 'path', value: "photo_407@20-08-2025_16-07-30"}] },
            { details: ["20.08.2025", "93 бригада", "Оборудование", "194х70", "205х110х127", "92", ""], photos: [{type: 'path', value: "photo_408@20-08-2025_16-09-04"}, {type: 'path', value: "photo_409@20-08-2025_16-09-04"}, {type: 'path', value: "photo_410@20-08-2025_16-09-04"}] },
            { details: ["20.08.2025", "93 бригада", "Оборудование", "120х75", "125х105х132", "92", ""], photos: [{type: 'path', value: "photo_411@20-08-2025_16-13-14"}, {type: 'path', value: "photo_412@20-08-2025_16-13-14"}, {type: 'path', value: "photo_413@20-08-2025_16-13-14"}, {type: 'path', value: "photo_414@20-08-2025_16-13-14"}, {type: 'path', value: "photo_415@20-08-2025_16-13-14"}] }
        ]
    },
    {
        address: "Сергієнка 70",
        items: [
            { details: ["20.08.2025", "Сергієнка 70", "Оборудование", "62х65", "75х80х205", "-", ""], photos: [{type: 'path', value: "photo_416@20-08-2025_16-15-40"}] },
            { details: ["20.08.2025", "Сергієнка 70", "Оборудование", "144х65", "150х91х125", "90", ""], photos: [{type: 'path', value: "photo_417@20-08-2025_16-18-14"}, {type: 'path', value: "photo_418@20-08-2025_16-18-14"}, {type: 'path', value: "photo_419@20-08-2025_16-18-14"}, {type: 'path', value: "photo_420@20-08-2025_16-18-14"}] }
        ]
    }
];

        let currentData;

        function saveData() {
            localStorage.setItem('equipmentReportData', JSON.stringify(currentData));
            const saveBtn = document.getElementById('save-btn');
            saveBtn.textContent = 'Сохранено!';
            setTimeout(() => {
                saveBtn.textContent = 'Сохранить изменения';
            }, 2000);
        }

        function makeCellEditable(cell, groupIndex, itemIndex, detailIndex) {
            cell.addEventListener('click', function() {
                if (cell.querySelector('input')) return;
                const currentValue = cell.textContent;
                const input = document.createElement('input');
                input.type = 'text';
                input.value = currentValue;
                input.style.width = '90%';
                cell.textContent = '';
                cell.appendChild(input);
                input.focus();

                const save = () => {
                    const newValue = input.value;
                    cell.textContent = newValue;
                    currentData[groupIndex].items[itemIndex].details[detailIndex] = newValue;
                };

                input.addEventListener('blur', save);
                input.addEventListener('keydown', e => {
                    if (e.key === 'Enter') {
                        input.blur();
                    }
                });
            });
        }

        function createPhotoElement(photo, groupIndex, itemIndex, photoIndex) {
            const photoContainer = document.createElement('div');
            photoContainer.className = 'photo-container';
            
            let imgSrc, fullImgSrc;
            if (photo.type === 'path') {
                imgSrc = `photos/${photo.value}_thumb.jpg`;
                fullImgSrc = `photos/${photo.value}.jpg`;
            } else { // base64
                imgSrc = photo.value;
                fullImgSrc = photo.value;
            }

            const img = document.createElement('img');
            img.src = imgSrc;
            img.onerror = function() {
                this.onerror = null;
                this.src = 'https://placehold.co/150x113/eee/ccc?text=Фото+не+найдено';
            };
            img.addEventListener('click', () => {
                const modal = document.getElementById("myModal");
                const modalImg = document.getElementById("modal-img");
                modal.style.display = "block";
                modalImg.src = fullImgSrc;
            });

            const deleteBtn = document.createElement('button');
            deleteBtn.className = 'delete-btn';
            deleteBtn.textContent = 'x';
            deleteBtn.addEventListener('click', () => {
                currentData[groupIndex].items[itemIndex].photos.splice(photoIndex, 1);
                renderTable(currentData);
            });
            
            photoContainer.appendChild(img);
            photoContainer.appendChild(deleteBtn);
            return photoContainer;
        }

        function createAddPhotoButton(groupIndex, itemIndex) {
            const addBtn = document.createElement('button');
            addBtn.className = 'add-photo-btn';
            addBtn.textContent = '+';
            addBtn.addEventListener('click', function() {
                const fileInput = document.createElement('input');
                fileInput.type = 'file';
                fileInput.accept = 'image/*';
                fileInput.onchange = e => {
                    const file = e.target.files[0];
                    if (!file) return;
                    const reader = new FileReader();
                    reader.onload = readerEvent => {
                        currentData[groupIndex].items[itemIndex].photos.push({
                            type: 'base64',
                            value: readerEvent.target.result
                        });
                        renderTable(currentData);
                    };
                    reader.readAsDataURL(file);
                };
                fileInput.click();
            });
            return addBtn;
        }

        function renderTable(data) {
            const tbody = document.querySelector('table tbody');
            tbody.innerHTML = ''; 

            data.forEach((group, groupIndex) => {
                const headerRow = document.createElement('tr');
                const headerCell = document.createElement('td');
                headerCell.colSpan = 7;
                headerCell.className = 'address-header';
                headerCell.textContent = group.address;
                headerRow.appendChild(headerCell);
                tbody.appendChild(headerRow);

                group.items.forEach((item, itemIndex) => {
                    const detailsRow = document.createElement('tr');
                    item.details.forEach((text, detailIndex) => {
                        const cell = document.createElement('td');
                        cell.className = 'editable';
                        cell.textContent = text;
                        makeCellEditable(cell, groupIndex, itemIndex, detailIndex);
                        detailsRow.appendChild(cell);
                    });
                    tbody.appendChild(detailsRow);

                    const photosRow = document.createElement('tr');
                    const photosCell = document.createElement('td');
                    photosCell.colSpan = 7;
                    photosCell.className = 'photos-cell';

                    item.photos.forEach((photo, photoIndex) => {
                        photosCell.appendChild(createPhotoElement(photo, groupIndex, itemIndex, photoIndex));
                    });
                    
                    photosCell.appendChild(createAddPhotoButton(groupIndex, itemIndex));
                    photosRow.appendChild(photosCell);
                    tbody.appendChild(photosRow);
                });
            });
        }

        function exportToExcel() {
            const headers = ["Дата", "Адрес", "Объект", "Выкладка (см)", "Габариты (ШхГхВ, см)", "Высота до стойки/полки (см)", "Примечания", "Фотографии"];
            const ws_data = [headers];

            currentData.forEach(group => {
                group.items.forEach(item => {
                    const photoNames = item.photos.map(p => {
                        if (p.type === 'path') {
                            return p.value + '.jpg';
                        }
                        return 'Новое фото (локальное)';
                    }).join(', ');
                    
                    const row = [...item.details, photoNames];
                    ws_data.push(row);
                });
            });

            const ws = XLSX.utils.aoa_to_sheet(ws_data);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, "Отчет");
            XLSX.writeFile(wb, "Отчет_по_оборудованию.xlsx");
        }

        document.addEventListener('DOMContentLoaded', () => {
            const savedData = localStorage.getItem('equipmentReportData');
            if (savedData) {
                currentData = JSON.parse(savedData);
            } else {
                currentData = defaultEquipmentData;
            }
            renderTable(currentData);
            
            document.getElementById('save-btn').addEventListener('click', saveData);
            document.getElementById('export-excel-btn').addEventListener('click', exportToExcel);

            document.getElementById('export-btn').addEventListener('click', () => {
                const dataString = `const defaultEquipmentData = ${JSON.stringify(currentData, null, 4)};`;
                const textarea = document.createElement('textarea');
                textarea.value = dataString;
                document.body.appendChild(textarea);
                textarea.select();
                try {
                    document.execCommand('copy');
                    alert('Данные для вставки в файл скопированы в буфер обмена!');
                } catch (err) {
                    alert('Не удалось скопировать данные. Пожалуйста, скопируйте вручную.');
                }
                document.body.removeChild(textarea);
            });

            // Modal close logic
            const modal = document.getElementById("myModal");
            const span = document.getElementsByClassName("close-modal")[0];
            span.onclick = function() { 
                modal.style.display = "none";
            }
            window.onclick = function(event) {
                if (event.target == modal) {
                    modal.style.display = "none";
                }
            }
        });
    </script>
</body>
</html>
